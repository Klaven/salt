def label = "mypod-${UUID.randomUUID().toString()}"

podTemplate(label: label, containers: [
        containerTemplate(name: 'opensuse', image: 'opensuse:42.3', ttyEnabled: true, command: 'cat'),
]) {
    node(label) {
        stage('Unit Tests') {
            checkout scm

            try {
                container('opensuse') {
                    sh 'zypper in --no-confirm python-tox'
                    sh 'tox -e unit'
                }
            } catch (Exception e) {
                containerLog 'opensuse'
                throw e
            }
        }
    }
}
